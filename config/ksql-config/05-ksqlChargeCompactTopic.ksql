CREATE TABLE wallbox_chargestatus
    WITH (
        KAFKA_TOPIC='wallbox_chargestatus',
        VALUE_FORMAT='AVRO'
  ) AS SELECT 
        CLIENT_ID_KEY, 
        LATEST_BY_OFFSET(CLIENT_ID) AS CLIENT_ID, 
        LATEST_BY_OFFSET(CHARGE) AS CHARGE, 
        SIGN(INSTR(LATEST_BY_OFFSET(CHARGE),'ready')) AS STATUS 
    FROM wallbox_charge 
    GROUP BY CLIENT_ID_KEY 
    EMIT CHANGES;